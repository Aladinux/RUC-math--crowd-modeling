\section{Results}
\label{sec:results}
In this section we describe the results obtained from our simulations.  The 
section is divided into two parts. In the first part we present some general 
results of our simulations, reviewing the general behaviour of our 
simulations. In the second part we present the results of our attempts to 
replicate the phenomena outlined in section~\ref{sec:article-results}. A 
discussion of these results is presented in section~\ref{sec:discussion}.

\subsection{The basics}
In this section we describe some general results of our simulations and the 
behaviour of our model. First we present the scenarios that we have simulated, 
and the parameters used in the simulations. We then move on to comment on the 
general behaviour of the pedestrians in our simulations and within which 
limits the simulations give reasonable results.

\subsubsection{Scenarios}
As outlined in section~\ref{sec:scenario-presentation}, we will simulate two 
different main scenarios, a square room and a corridor, with some variations 
of the latter. Counting these variations, we simulate four different 
scenarios: A rectangle shaped room with a door in the middle of one of the 
walls, and a normal corridor, a corridor with a bottleneck in the middle and a 
corridor with a sudden open space. In the corridors we do simulations of both 
uni-- and birectional flow. Images of each of these scenarios are presented in 
figure \ref{fig:fourcases}.

\begin{figure}[h]
\centering
\begin{minipage}{0.45\textwidth}
    \centering
    \subfloat[Square room.]{\resizebox{0.7\textwidth}{!}{\input{Figures/squareroomps.tex}}} 
    \\
    \subfloat[Corridor.]{\resizebox{\textwidth}{!}{\input{Figures/normalcorridorps.tex}}}
\end{minipage}
\begin{minipage}{0.45\textwidth}
    \centering
    \vspace{1.4cm}
    \subfloat[Bottleneck.]{\resizebox{\textwidth}{!}{\input{Figures/bottleneckps.tex}}} 
    \\
    \vspace{6mm}
    \subfloat[Corridor with an opening.]{\resizebox{\textwidth}{!}{\input{Figures/widekinksps.tex}}}
\end{minipage}
\caption{Images of the four scenarios we simulate.}
\label{fig:fourcases}
\end{figure}

\subsubsection{Parameters}
As explained in section~\ref{sec:varying-constants}, we start out with the 
model parameters outlined in section~\ref{sec:init-cond} and vary them when 
necessary to get useful results from the simulations.  The values we use 
initially are summarised in table \ref{tbl:parameter-settings}. Whenever a 
parameter is changed from these values, we will point it out and explain why 
the change has been necessary.

\begin{table}[ht]
    \begin{center}
        \begin{tabular}{l c r}
            \toprule
            \textbf{Description} & \textbf{Symbol} & \textbf{Value} \\
            \midrule
            \multicolumn{3}{c}{\textsf{Constants}}\\
            Interaction strength & A & $3,0$ \\
            Interaction range & B & $0,2$ \\
            Anisotropic constant & $\lambda$ & $0,75$ \\
            Wall repulsion strength & $U$ &  $10,0$ \\
            \midrule
            \multicolumn{3}{c}{\textsf{Initial conditions}}\\
            Mean pedestrian radius & $R_\alpha$ & $0,3 \pm 0,05 m$\\
            Mean desired velocity &  $V^{Id}_\alpha$ &  $1,34 \pm 0,26
            \frac{m}{s}$ \\
            Max velocity factor &  &  $1,3$ \\
            Relaxation time & $\tau$ & $1,0 s$\\
            \bottomrule
        \end{tabular}
        \caption[Model parameters]{Model parameters used for the simulations.  
        $\pm$ indicates standard deviation in Gaussian distributed values.}
        \label{tbl:parameter-settings}
    \end{center}
\end{table}

\subsubsection{General behaviour of the model}
Our simulations have shown that it is indeed possible to create simulations 
that upon visual inspection show reasonable behaviour of the pedestrians. That 
is, pedestrians move through the scenarios without passing through walls or 
each other, and we see clogging of exits as we expected. However, the 
behaviour is very much dependent on the parameter values. This means that if, 
for example, the mean initial desired velocity for the pedestrians is 
increased, pedestrians will start walking through each other and the walls.  
This can be remedied by also increasing the parameters controlling the 
magnitude of the repulsive forces, which indicates that there is some 
interdependence of the parameters. We have not done a detailed analysis of 
this, though.

For examples of simulations we've made films available along with the source 
code for the simulations\footnote{See 
\url{http://akira.ruc.dk/~tohojo/crowd-modelling}.}.

\subsection{The results from the literature}\label{subsec:ThePhenomena}
In this section we present the results we obtained from our attempts
to replicate the results from the literature outlined in 
section~\ref{sec:article-results}.  For each of the results we will go into a 
bit more detail on the phenomenon we seek to replicate, and then present how 
well our results match the expected. The results we replicate are presented in 
detail in several different articles, but according to \cite{self-org}, they 
should all be possible to see using the model we are simulating.

\subsubsection{The faster-is-slower effect}
As mentioned in section~\ref{sec:article-results}, the faster-is-slower effect 
is seen when pedestrians leave a room. The effect is that faster desired 
movement speeds yield a longer time to empty the room, contrary to what might 
be expected. The results from \cite{helbing00} where this effect is described 
can be seen in figure~\ref{fig:LtNFasterIsSlower}. Here it is apparent that 
clogging occurs at the doorway (figure~\ref{subfig:fast-slow-clogging}), 
leading to a longer time to clear the room for desired velocities above 
$1,5m/s$ (figure~\ref{subfig:fast-slow-graph}).

\begin{figure}[h]
    \centering
    \subfloat[Clogging at the exit.]{
        \includegraphics[width=0.45\textwidth]{Figures/square_room_letters.png}
        \label{subfig:fast-slow-clogging}
    }
    \subfloat[Leaving time versus desired velocity.]{
        \includegraphics[width=0.45\textwidth]{Figures/leaving_time.png}
        \label{subfig:fast-slow-graph}
    }
    \caption{This is the reuslts for the leaving time as a function of the desired 
    velocity. The results are made for a squared romm of $15m*15m$ and $200$ 
    pedestrians leaving the room. It is very clear to see that they get the 
    faster-is-slower effect.}
    \label{fig:LtNFasterIsSlower}
\end{figure}

The faster-is-slower was expected to be seen in the square room scenario.
To see if this effects occurs we have looked at the leaving time as a function
of the desired velocity of the pedestrains. We made simulations with a desired
velocity going from $1.5m/s$ to $5m/s$ with steps of 0.1. The results are presented
in figure \ref{fig:isfasterslower}. We see some fluctutation on the graph, but the
overall picture of the leaving time decreasing when the desired velocity goes up is
clear. So there no sign of an increase of the leaving time and therefore no faster
is slower. The only thing we see is that the negative slope is decreasing, meaning
that if the pedestrians moves twice as fast, they don't clear the room in half the
time.

\begin{figure}[h]
    \centering
    \subfloat[Attempt to see the faster-is-slower effect in the square 
    room.]{\includegraphics[scale=0.45]{Figures/fastIsSlowNot.pdf}}
    \subfloat[Attempt to see the faster-is-slower effect in the normal corridor 
    case.]{\includegraphics[scale=0.45]{Figures/corridor-flowrate-aggr-velocity_mean.pdf}}\\
    \subfloat[Attempt to see the faster-is-slower effect in the bottleneck 
    scenario.]{\includegraphics[scale=0.45]{Figures/bottleneck-flowrate-aggr-velocity_mean.pdf}}
    \subfloat[Attempt to see the faster-is-slower efffect in the corridor with a 
    wide 
    space.]{\includegraphics[scale=0.45]{Figures/Wide-kink-one-directional-flowrate-agg.pdf}}
    \caption{There is no evidence of the-faster-is slower effect, however it does 
    seem that we see a faster-is-only-slightly-faster effect.}
    \label{fig:isfasterslower}
\end{figure}
%TODO: We should make runs with the desired velcity.
%This is what they compare with in the letters to nature article.



\subsubsection{Freezing by heating effect}
According to \cite{self-org} the freezing by heating effect should
arise when the max desired velocity of the pedestrians is raised in
situations where there is biderectional flow. We however does not
experience this in any of our simulations of the corridor. We tried
to raise the max velocity, see figure \ref{fig:freezingbyheating1} and
figure \ref{fig:freezingbyheating05}, but instead of observing the
freezing by heating effect, we actually saw that the pedestrians got
through the corridor more easily, and that the density in the corridor
was lower when the max velocity was high. So like the faster is slower
effect again we see no sign of a high desired velocity decreasing/stopping
the movement of the pedestrians.

From the litteratture they show the freezing by heating by showing figures of a complete blocking of the pedestrians. An example of the can be seen on \cite{oscil}, which i shown on figure \ref{fig:freezing_by_heating_litterature}

\begin{figure}[h]
\centering
\subfloat[]{\includegraphics[width=0.45\textwidth]{Figures/heatfreeze.png}}
\caption{Here we can see the pedestrians blocking each other as a result of the freezing by heating. Taken from \cite{oscil}.}
\label{fig:freezing_by_heating_litterature}
\end{figure}


\subsubsection{Lane formation}
Lane formation was expected to happen in the case of bidirectional
flow in corridors. In the article \ref{self-org} you read the following
statement:

\begin{quote}
If pedestrians crowds moving in opposite directions meet each other,
they form small \emph{channels} in the beginning, but these channels
later merge to produce wide lanes
\end{quote}

Since we have three different corridor cases we have looked for lane
formation in all of them. The results are presented in figurewhereas
\ref{fig:laneformation}. Lane formation is observed in every case
and they are of the nature described in \cite{self-org}.\\

\begin{figure}[h]
\centering
\subfloat[Bidirectional flow in corridor.]{\resizebox{8cm}{!}{\input{Figures/corridor-01012.tex}}}
\subfloat[Bidirectional flow in bottleneck.]{\resizebox{8cm}{!}{\input{Figures/corridor-01899.tex}}}\\
\subfloat[Bidirectional flow in corridor with an open space.]{\resizebox{8cm}{!}{\input{Figures/corridor-01999.tex}}}
\caption{Lane formation in the different corridors.}
\label{fig:laneformation}
\end{figure}

From the litterature we can see that they present figures of lane formations
 that looks like what we are seeing. They do how ever manily stick with the normal corridor. One of these results are shown in \cite{lanes}, which can be seen on figure \ref{fig:laneformation_litterature}
\begin{figure}[h]
\centering
\subfloat[]{\includegraphics[width=8cm]{Figures/flow_lanes_litterature.png}}
\caption{Lane formation through a corridor. Taken from \cite{lanes}.}
\label{fig:laneformation_litterature}
\end{figure}
 


\subsubsection{The Oscillatory flow}
The oscillatory flow is expected to arise in the case of bidirectional
flow through a bottleneck. The results are presented in figure
\ref{fig:oscillitoryflow}.\\

When looking at the simulation while it is running it is not
immediately clear that the oscillatory flow occurs. Clogging
appears in both ends of the bottleneck and people are sometimes
squeezed through the bottleneck. The graph presented in
\ref{fig:oscillitoryflow} does indicate that the oscillatory
flow occurs.

In the article \cite{oscil}, they show a figure of the oscillatory flow. They 
don't show any graph of the flow in different directions or anything like 
that, but basicly just shows a screen shot giving some idea about the 
phenomena along with a discribtion of the phenomena. They describe it as the 
pressure building up from one side and the at some point a small group of 
pedestrians slip through. When that happens the pressure on the other side 
builds up and then at some time some pedestrians from that side slips through 
and so on. Figure \ref{fig:oscillitoryflow_litterature} shows the 
presentations of the oscillatory flow from \cite{oscil}. This describtions 
fits with what we ourself experince through simulations of the model too.

\begin{figure}[h]
\centering
\subfloat[Screen shot of oscillatory flow from 
\cite{oscil}]{\includegraphics[width=0.5\textwidth]{Figures/oscil_flow.png}}
\caption{Here one can see that some black pedestrians that already have slip through and now the white pedestrians going in the other direction a passing through the bottleneck.}
\label{fig:oscillitoryflow_litterature}
\end{figure}


\subsection{Summery}
We have been able to get a working simulation of the social force model 
presented in \cite{self-org} with components taken from \cite{ABconstant}. 
The most basic dynamics og the simulations seems to be running like as it 
should and our simulations show lane formation in bidirectional flow. We also  
see oscillatory flow at bottlenecks however freezin-by-heating 
and faster-is-slower effect is not observed at all.
