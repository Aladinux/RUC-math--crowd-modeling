\section{Results}
\label{sec:results}
In this section we describe the results obtained from our simulations.  The 
section is divided into two parts. In the first part we present some general 
results of our simulations, reviewing the general behaviour of our 
simulations. In the second part we present the results of our attempts to 
replicate the phenomena outlined in section~\ref{sec:article-results}. A 
discussion of these results is presented in section~\ref{sec:discussion}.

\subsection{The basics}
In this section we describe some general results of our simulations. 
First we present the scenarios that we have simulated, and the parameters 
used in the simulations. We then move on to comment on the general behaviour 
of the pedestrians in our simulations and within which limits the simulations 
give reasonable results.

\subsubsection{Scenarios}
As outlined in section~\ref{sec:scenario-presentation}, we will simulate two 
different main scenarios, a square room and a corridor, with some variations 
of the latter. Counting the variations, we simulate three different scenarios: 
A rectangle shaped room with a door in the middle of one of the walls, and a 
normal corridor and a corridor with a bottleneck in the middle.  In the 
corridors we do simulations of both uni-- and birectional flow. Images of each 
of these scenarios are presented in figure \ref{fig:simulated-cases}.

\begin{figure}[h]
    \centering
    \subfloat[Square room.]{
        \resizebox{0.45\textwidth}{!}{\input{Figures/squareroomps.tex}}
        \label{subfig:image-square-room}
    }\\
    \subfloat[Corridor.]{
        \resizebox{0.45\textwidth}{!}{\input{Figures/normalcorridorps.tex}}
        \label{subfig:image-corridor}       
    }
    \subfloat[Bottleneck.]{
        \resizebox{0.45\textwidth}{!}{\input{Figures/bottleneckps.tex}}
        \label{subfig:image-bottleneck}
    }
    \caption{Images of the three scenarios we simulate.}
    \label{fig:simulated-cases}
\end{figure}

\subsubsection{Parameters}
As explained in section~\ref{sec:varying-constants}, we start out with the 
model parameters outlined in section~\ref{sec:init-cond} and vary them when 
necessary to get useful results from the simulations.  The values we use 
initially are summarised in table \ref{tbl:parameter-settings}. Whenever a 
parameter is changed from these values, we will point it out and explain why 
the change has been necessary.

\begin{table}[ht]
    \begin{center}
        \begin{tabular}{l c r}
            \toprule
            \textbf{Description} & \textbf{Symbol} & \textbf{Value} \\
            \midrule
            \multicolumn{3}{c}{\textsf{Constants}}\\
            Interaction strength & A & $3,0$ \\
            Interaction range & B & $0,2$ \\
            Anisotropic constant & $\lambda$ & $0,75$ \\
            Wall repulsion strength & $U$ &  $10,0$ \\
            \midrule
            \multicolumn{3}{c}{\textsf{Initial conditions}}\\
            Mean pedestrian radius & $R_\alpha$ & $0,3 \pm 0,05 m$\\
            Mean desired velocity &  $V^{Id}_\alpha$ &  $1,34 \pm 0,26
            \frac{m}{s}$ \\
            Max velocity factor &  &  $1,3$ \\
            Relaxation time & $\tau$ & $1,0 s$\\
            \bottomrule
        \end{tabular}
        \caption[Model parameters]{Model parameters used for the simulations.  
        $\pm$ indicates standard deviation in Gaussian distributed values.}
        \label{tbl:parameter-settings}
    \end{center}
\end{table}

\subsubsection{General behaviour of the model}
Our simulations have shown that it is indeed possible to create simulations 
that upon visual inspection show reasonable behaviour of the pedestrians. That 
is, pedestrians do not pass through the walls or each other, and we see 
clogging of exits as we expected. However, the behaviour is very much 
dependent on the parameter values. This means that if, for example, the mean 
initial desired velocity for the pedestrians is increased, pedestrians will 
start walking through each other and the walls. This can be remedied by also 
increasing the parameters controlling the magnitude of the repulsive forces, 
which indicates that there is some interdependence of the parameters. We have 
not done a detailed analysis of this, though.

For examples of simulations we've made films available along with the source 
code for the simulations\footnote{See 
\url{http://akira.ruc.dk/~tohojo/crowd-modelling}.}.

\subsection{The results from the literature}\label{subsec:ThePhenomena}
In this section we present the results we obtained from our attempts
to replicate the results from the literature outlined in 
section~\ref{sec:article-results}.  For each of the results we will go into 
more detail on the phenomenon we seek to replicate, and then present how well 
our results match the expected. The results we replicate are presented in 
detail in several different articles, but according to \cite{self-org}, they 
should all be possible to see using the model we are simulating.

\subsubsection{The faster-is-slower effect}
As mentioned in section~\ref{sec:article-results}, the faster-is-slower effect 
is seen when pedestrians leave a room. The effect is that faster desired 
movement speeds yield a longer time to empty the room, contrary to what might 
be expected. The results from \cite{helbing00} where this effect is described 
can be seen in figure~\ref{fig:LtNFasterIsSlower}. Here it is apparent that 
clogging occurs at the doorway (figure~\ref{subfig:fast-slow-clogging}), 
leading to a longer time to clear the room for desired velocities above 
$1,5m/s$ (figure~\ref{subfig:fast-slow-graph}).

\begin{figure}[ht]
    \centering
    \subfloat[Clogging at the exit.]{
        \includegraphics[width=0.45\textwidth]{Figures/square_room_letters.png}
        \label{subfig:fast-slow-clogging}
    }
    \subfloat[Leaving time versus desired velocity.]{
        \includegraphics[width=0.45\textwidth]{Figures/leaving_time.png}
        \label{subfig:fast-slow-graph}
    }
    \caption[Faster-is-slower effect from \cite{helbing00}]{Faster-is-slower 
    effect from \cite{helbing00}. \subref{subfig:fast-slow-clogging} Clogging 
    occurs at doorways. \subref{subfig:fast-slow-graph} Fast desired 
    velocities leads to slower emptying of the room.}
    \label{fig:LtNFasterIsSlower}
\end{figure}

In our simulations of the square room scenario we have clogging in the 
doorways as expected (see figure~\ref{subfig:image-square-room}). 

In \cite{helbing00} they simulate a square room with dimensions 
$15\text{m} \cdot 15\text{m}$ with $200$ pedestrians as shown in 
figure \ref{fig:LtNFasterIsSlower}. In order to compare our results 
with theirs we simulate a corresponding scenario.

It has been necessary to lower the relaxation time of the pedestrians, $\tau$, 
from $1$ to $0.95$ when doing these simulation because with $\tau = 1$ the 
pedestrians would end up in a locked state in front of the door when there are 
three or four pedestrians left, where the repulsion between the pedestrians 
prevent either of them of passing through the doorway. With a lower value of 
$\tau$ this effect does not occur. 

It has also been necessary to remove the variation of the mean velocity when 
working at low velocities because some pedestrians ended up with an extremely 
low initial desired velocity which resulted in extremely high leaving times 
(for further discussion of this, see section~\ref{sec:random-errors}).

When we plot the time to leave the room as a function of the initial desired 
velocity with values from $0,75$ to $3,0$, as shown in 
figure~\ref{fig:square-room-leaving}, we do not see the leaving time increase 
with initial desired speed within any specific interval.  Looking at the 
results, we conclude that we do not see the faster-is-slower effect.

We choose to stop the initial desired speed at $3.0 \text{m}/\text{s}$ because 
if you increase it beyond this value people will start going through the walls 
and each other. One could avoid this by also increasing the wall potential and 
the strength of the social force, but such adjustments are not mentioned in 
the article. How they have managed to run model simulations with the initial 
desired velocity set to $10.0 \text{m}/\text{s}$ without seeing these errors 
is not clear.

\begin{figure}[ht]
    \centering
    \subfloat[Screen shot taken from the simulation]{
        \resizebox{0.35\textwidth}{!}{\input{Figures/time-to-clear-room.tex}}
    }
    \subfloat[Time to clear the room as a function of mean desired velocity.]{
        \includegraphics[width=0.65\textwidth]{Figures/time-to-clear.pdf}
    }
    \caption[Leaving time for the square room]{Leaving time for the square 
    room. We do not see the increase in leaving time as we increase the 
    initial desired speed.}
    \label{fig:square-room-leaving}
\end{figure}

\subsubsection{Lane formation}
Lane formation happens when the simulation contains bidirectional flow in 
corridors. As stated in \ref{self-org}:

\begin{quote}
    If pedestrians crowds moving in opposite directions meet each other, they 
    form small \emph{channels} in the beginning, but these channels later 
    merge to produce wide lanes
\end{quote}

An illustration of this phenomenon from \cite{lanes} can be seen in 
figure~\ref{fig:lanes-literature}. 

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{Figures/flow_lanes_litterature.png}
    \caption[Lane formation from \cite{lanes}]{Lane formation from 
    \cite{lanes}. Pedestrians through a corridor form alternating lanes of 
    pedestrians going in each direction.}
    \label{fig:lanes-literature}
\end{figure}

Since we have two different corridor cases we have looked for lane
formation in both of them. As can be seen in figure~\ref{fig:laneformation}, 
the lane formation occurs in both cases.

\begin{figure}[h]
    \centering
    \subfloat[Bidirectional flow in a corridor.]{
        \resizebox{0.45\textwidth}{!}{\input{Figures/corridor-01012.tex}}
    }
    \subfloat[Bidirectional flow in a corridor with a bottleneck.]{
        \resizebox{0.45\textwidth}{!}{\input{Figures/corridor-01899.tex}}
    }
    \caption[Lane formation in corridor simulations]{Lane formation in 
    corridor simulations. The colours indicate the direction the pedestrians 
    are moving in. The blue ones are walking to the left; the green ones are 
    walking to the right. Lane formation can be seen in both cases. }
    \label{fig:laneformation}
\end{figure}

\subsubsection{Freezing by heating effect}
The freezing by heating effect occurs when the lane formations break down due 
to extreme densities. This results in a clogging that brings the pedestrians 
to a complete halt (see section~\ref{sec:article-results}).  The illustration 
of this effect as presented in \cite{oscil} can be seen in 
figure~\ref{fig:freezing_by_heating_litterature}.

\begin{figure}[h]
    \centering
    \subfloat[Freezing by heating effect from \cite{oscil}.]{
        \includegraphics[width=0.45\textwidth]{Figures/heatfreeze.png}
    }
    \subfloat[Freezing-by-heating effect from our simulation.]{
        \resizebox{0.45\textwidth}{!}{\input{Figures/freezing-by-heating.tex}}
    }
    \caption[Freezing-by-heating effect from \cite{oscil} compared with our 
    own.]{Freezing-by-heating effect from \cite{oscil} compared with our own.}
    \label{fig:freezing_by_heating_litterature}
\end{figure}

We have been able to reproduce the freezing-by-heating effect in both corridor 
cases. Actually, in most cases run with a high density of pedestrians, we see 
the effect in our simulations.  

\subsubsection{Oscillating flows}
Oscillating flows occur when clogging occurs at a bottleneck, and small groups 
of pedestrians from each direction alternate in getting through the 
bottleneck. The effect is described in \cite{oscil}, but it is not clear how 
they measure it. Figure~\ref{fig:oscillitoryflow_litterature} shows the 
illustration from the article that explains the effect.

When looking at the simulation, it is apparent that clogging appears in both 
ends of the bottleneck and people are sometimes squeezed through the 
bottleneck, but it is not immediately clear whether this constitutes an 
oscillating flow.  To get a better indication of whether or not oscillation 
occurs, we have graphed the flow rate in each direction. This graph is seen in 
figure~\ref{fig:oscillatory-flow}. The graph does not show a clear indication 
of oscillating flows, however a possible source of error is that the flow rate 
is measured at the ends of the corridor, which may dilute the effect as 
pedestrians are passing through the crowd after having passed through the 
bottleneck. However, in the way our simulation is implemented, it is not 
possible to distinguish between pedestrians moving in different directions 
when measuring the flow rate in the middle of the bottleneck.

In conclusion, we may be able to replicate the oscillating flows, but the 
results are not completely clear.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.4\textwidth]{Figures/oscil_flow.png}
    \caption[Illustration of oscillating flow from \cite{oscil}]{Illustration 
    of oscillating flow from \cite{oscil}. A small group of pedestrians 
    slipping through the bottleneck passes through the bottleneck in one 
    direction. Oscillations occur when pedestrians alternately pass through 
    the bottleneck from each direction.}
    \label{fig:oscillitoryflow_litterature}
\end{figure}

\begin{figure}[h]
    \centering
    \subfloat[Flowrates measured at each end of the corridor]{
        \includegraphics[width=0.45\textwidth]{Figures/flowrateBiDirecBottle.pdf}
        \label{subfig:flow-graph}
    }
    \subfloat[Clogging of a bottleneck]{
        \resizebox{0.45\textwidth}{!}{\input{Figures/corridorbottleBiClog.tex}}
        \label{subfig:bottleneck}
    }\\
    
    \caption[Oscillatory flow simulations]{Oscillatory flow simulations. 
    \subref{subfig:flow-graph} Flowrates measured at each end of the corridor 
    of a simulation. While there is some alternating behaviour it is not clear 
    whether oscillatory flow occurs. \subref{subfig:bottleneck} Clogging at a 
    bottleneck when pedestrians approach it from both directions.}
    \label{fig:oscillatory-flow}
\end{figure}

\subsection{Summary}
We have seen that our simulation is able to show reasonable results of 
pedestrians moving through our chosen scenarios. We have simulated three  
different scenarios, and tried to replicate the results presented in the 
literature. We have not been able to replicate the faster-is-slower effect. 
Lane formation and freezing-by-heating we do see, and it is unclear whether 
oscillating flows are seen, perhaps partly because our way of measuring this 
is not very good.
