\section{Results}
\label{sec:results}
In this section we describe the results obtained from our simulations.
The section is devided into two parts. The first part presents the
constants we use and the scenarios that we simulate and comment on
the general success of our implementation of the model. We looked
for unrealistic or unexpected behavior in our simulations. In the
last part we present the results from our attempts to replicate
the phenomena presented in \cite{self-org}.Possible remedies for
any discrepancies between the expected and the actual results are
discussed in section~\ref{sec:discussion}.

\subsection{The basics}
This section is devided into three parts. First we present the
scenarios that we have simulated, then we present the constants
used in the simulations. We then move on to comment on the
general behavior of the pedestrians in our simulations.

\subsubsection{Scenarios}
We simulate four different scenarios, a rectangle shaped room with a
door in the middle of one of the walls, and three different variations
of corridors; a normal corridor, a corridor with a bottleneck in the
middle and a corridor with a sudden open space. In the corridors we have
the opportunity to make bidirectional flow. Screen shots from each
scenario are presented in figure \ref{fig:fourcases}.

\begin{figure}[h]
\centering
\subfloat[Square room.]{\resizebox{4cm}{!}{\input{Figures/squareroomps.tex}}}
\subfloat[Bottleneck.]{\resizebox{7cm}{!}{\input{Figures/bottleneckps.tex}}}\\
\subfloat[Corridor.]{\resizebox{7cm}{!}{\input{Figures/normalcorridorps.tex}}}
\subfloat[Corridor with an opening.]{\resizebox{7cm}{!}{\input{Figures/widekinksps.tex}}}
\caption{Screen shots of our four different scenarios.}
\label{fig:fourcases}
\end{figure}

\subsubsection{Constants}
In the simulation the parameters are set after \cite{ABconstant} and
\cite{self-org}, to see if we can replicate their simulations and results.
The general values we use are presented in table \ref{tbl:parameter-settings}.
We will through the chapter mention when the values are changed for a
specific case.

\begin{table}[ht]
    \begin{center}
        \begin{tabular}{l c r}
            \toprule
            \textbf{Description} & \textbf{Symbol} & \textbf{Value} \\
            \midrule
            \multicolumn{3}{c}{\textsf{Constants}}\\
            Interaction strength & A & $3,0$ \\
            Interaction range & B & $0,2$ \\
            Anisotropic constant & $\lambda$ & $0,75$ \\
            Wall repulsion strength & $U$ &  $2,0$ \\
            \midrule
            \multicolumn{3}{c}{\textsf{Initial conditions}}\\
            Mean pedestrian radius & $R_\alpha$ & $0,3 \pm 0,05 m$\\
            Mean desired velocity &  $V^{Id}_\alpha$ &  $1,34 \pm 0,26
            \frac{m}{s}$ \\
            Max velocity factor &  &  $1,3$ \\
            Relaxation time & $\tau$ & $1,0 s$\\
            \bottomrule
        \end{tabular}
        \caption[Constants and initial conditions]{Constants and initial
        conditions used for the simulations. $\pm$ indicates standard
        deviation in Gaussian distributed values.}
        \label{tbl:parameter-settings}
    \end{center}
\end{table}

\subsubsection{General behavior}
In this section we make some comments on the general behavior of
the pedestrians in the simulations. We checked for intersections between
the pedestrians, pedestrians crossing the walls and other bahavior that might
be relevant for the further investigations. We used the parameters in table
\ref{tbl:parameter-settings}.\\

\begin{figure}[h]
\centering
\subfloat[Pedestrians overlapping]{\includegraphics[scale=0.45]{Figures/pedestiranoverlapping.pdf}}
\subfloat[Overlapping between pedestrians and a wall]{\includegraphics[scale=0.45]{Figures/walloverlapping.pdf}}
\caption{The figure shows two simulations of the squared room. We see the overlapping that can occur between two pedestrians and between the walls and pedestrians. This kind of intersection is seen in most simulations, but they don't cross completely. The red dot on the figures are the desired locations}
\label{fig:overlapping}
\end{figure}

In the figure \ref{fig:overlapping} the overlapping between pedestrians
themselves and between walls and pedestrians. We see that in some situations
it is possible for the pedestrians to intersect quite alot, almost reaching
each others centers. The same thing is seen for the walls, where the wall
can get quite close to the center of a pedestrians. But inspite of this
we don't, with the chosen constants, see that they actually do cross. So
even though it might look like they get sqiuzzed alot together, no completely
unrealistic situations occur. Also we see no other strange scenarios, like
people going in a wrong direction or anything like that. So the most basic
requirements of the model are fulfilled.

We do however see some unrealistic behavior when we change the values in
\ref{tbl:parameter-settings} When looking at some of the different phenomenons,
we need to change certain values like the mean velocity. But when we do
this it starts to get unrealistic. When raising the desired velocity to
a speed like $2.5m/s$, we start to see people crossing each other and going
up to $3.5m/s$ we start to see people crossing the walls. This is a problem
since these results makes no sence to compares with. Lowering the timestep
with $1/10$ doesn't change this result at all. So to solve this problem we
have in some cases raised the wallues of the wall constant $U$ and the
pedestrains repulsion constant $A$. This makes the repulsions forces
big enough for the pedestrians to act 'noraml'. We will throughout the
chapter mention when we change the values and how much it is changed.

\subsection{The phenomena}\label{subsec:ThePhenomena}
In this section we present the results we obtained from our attempts
to replicate the phenomenons presented in \cite{self-org}. These phenomenos are described in section 
\ref{phenomenon}. We will include figure from vairious articles to having something concrete to compare
our results with. The reason we use different articles is because there is not one single article that contains figure of all the scenarios at once. 

\subsubsection{The faster-is-slower effect}
The faster-is-slower was expected to be seen in the square room scenario.
To see if this effects occurs we have looked at the leaving time as a function
of the desired velocity of the pedestrains. We made simulations with a desired
velocitygoing from $1.5m/s$ to $5m/s$ with steps of 0.1. The results are presented
in figure \ref{fig:isfasterslower}. We see some fluctutation on the graph, but the
overall picture of the leaving time decreasing when the desired velocity goes up is
clear. So there no sign of an increase of the leaving time and therefore no faster
is slower. The only thing we see is that the negative slope is decreasing, meaning
that if the pedestrians moves twice as fast, they don't clear the room in half the
time.

\begin{figure}[h]
\centering
\subfloat[Attempt to see the faster-is-slower effect in the square 
room.]{\includegraphics[scale=0.45]{Figures/fastIsSlowNot.pdf}}
\subfloat[Attempt to see the faster-is-slower effect in the normal corridor 
case.]{\includegraphics[scale=0.45]{Figures/corridor-flowrate-aggr-velocity_mean.pdf}}\\
\subfloat[Attempt to see the faster-is-slower effect in the bottleneck 
scenario.]{\includegraphics[scale=0.45]{Figures/bottleneck-flowrate-aggr-velocity_mean.pdf}}
\subfloat[Attempt to see the faster-is-slower efffect in the corridor with a 
wide 
space.]{\includegraphics[scale=0.45]{Figures/Wide-kink-one-directional-flowrate-agg.pdf}}
\caption{There is no evidence of the-faster-is slower effect, however it does 
seem that we see a faster-is-only-slightly-faster effect.}
\label{fig:isfasterslower}
\end{figure}
%TODO: We should make runs with the desired velcity.
%This is what they compare with in the letters to nature article.
If we compare with the litterature they show a graph of the leaving time in 
\cite{helbing00}. This graph can be seen on figure 
\ref{fig:LtNFasterIsSlower}. Here it is clearly seen that the leaving time is 
going up when the desired velocity is going up. Quite the opposite result of 
what we are getting. It should be noted that the article these results are 
from, includes tangential forces between the pedestrians. Whereas we do only 
include the repulsion directly away form the pedstrians. In our main article 
\cite{self-org} though, they specific mention the tangential force as making a 
little to none difference in the results. This claim is quoted in section 
\ref{sec:social-forces}.
\begin{figure}[h]
\centering
\subfloat[Square room from case from 
\cite{helbing00}.]{\includegraphics[width=0.45\textwidth]{Figures/square_room_letters.png}}
\subfloat[Graph of the leaving time for the squared room as a function of max. 
desired velocity]{\includegraphics[width=0.45\textwidth]{Figures/leaving_time.png}}
\caption{This is the reuslts for the leaving time as a function of the desired 
velocity. The results are made for a squared romm of $15m*15m$ and $200$ 
pedestrians leaving the room. It is very clear to see that they get the 
faster-is-slower effect.}
\label{fig:LtNFasterIsSlower}
\end{figure}



\subsubsection{Freezing by heating effect}
According to \cite{self-org} the freezing by heating effect should
arise when the max desired velocity of the pedestrians is raised in
situations where there is biderectional flow. We however does not
experience this in any of our simulations of the corridor. We tried
to raise the max velocity, see figure \ref{fig:freezingbyheating1} and
figure \ref{fig:freezingbyheating05}, but instead of observing the
freezing by heating effect, we actually saw that the pedestrians got
through the corridor more easily, and that the density in the corridor
was lower when the max velocity was high. So like the faster is slower
effect again we see no sign of a high desired velocity decreasing/stopping
the movement of the pedestrians.

From the litteratture they show the freezing by heating by showing figures of a complete blocking of the pedestrians. An example of the can be seen on \cite{oscil}, which i shown on figure \ref{fig:freezing_by_heating_litterature}

\begin{figure}[h]
\centering
\subfloat[]{\includegraphics[width=0.45\textwidth]{Figures/heatfreeze.png}}
\caption{Here we can see the pedestrians blocking each other as a result of the freezing by heating. Taken from \cite{oscil}.}
\label{fig:freezing_by_heating_litterature}
\end{figure}


\subsubsection{Lane formation}
Lane formation was expected to happen in the case of bidirectional
flow in corridors. In the article \ref{self-org} you read the following
statement:

\begin{quote}
If pedestrians crowds moving in opposite directions meet each other,
they form small \emph{channels} in the beginning, but these channels
later merge to produce wide lanes
\end{quote}

Since we have three different corridor cases we have looked for lane
formation in all of them. The results are presented in figurewhereas
\ref{fig:laneformation}. Lane formation is observed in every case
and they are of the nature described in \cite{self-org}.\\

\begin{figure}[h]
\centering
\subfloat[]{\resizebox{8cm}{!}{\input{Figures/corridor-01012.tex}}}
\subfloat[]{\resizebox{8cm}{!}{\input{Figures/corridor-01012.tex}}}\\
\subfloat[]{\resizebox{8cm}{!}{\input{Figures/corridor-01012.tex}}}
\caption{Lane formation in the different corridors.}
\label{fig:laneformation}
\end{figure}

From the litterature we can see that they present figures of lane formations
 that looks like what we are seeing. They do how ever manily stick with the normal corridor. One of these results are shown in \cite{lanes}, which can be seen on figure \ref{fig:laneformation_litterature}
\begin{figure}[h]
\centering
\subfloat[]{\includegraphics[width=8cm]{Figures/flow_lanes_litterature.png}}
\caption{Lane formation through a corridor. Taken from \cite{lanes}.}
\label{fig:laneformation_litterature}
\end{figure}
 


\subsubsection{The Oscillatory flow}
The oscillatory flow is expected to arise in the case of bidirectional
flow through a bottleneck. The results are presented in figure
\ref{fig:oscillitoryflow}.\\

\begin{figure}[h]
\centering
{\resizebox{7cm}{!}{\input{Figures/corridor-01012.tex}}}
\caption{A screen shot of bidirectional flow in the bottlenck}
\label{fig:oscillitoryflow}
\end{figure}

When looking at the simulation while it is running it is not
immediately clear that the oscillatory flow occurs. Clogging
appears in both ends of the bottleneck and people are sometimes
squeezed through the bottleneck. The graph presented in
\ref{fig:oscillitoryflow} does indicate that the oscillatory
flow occurs.

In the article \cite{oscil}, they show a figure of the oscillatory flow. They 
don't show any graph of the flow in different directions or anything like 
that, but basicly just shows a screen shot giving some idea about the 
phenomena along with a discribtion of the phenomena. They describe it as the 
pressure building up from one side and the at some point a small group of 
pedestrians slip through. When that happens the pressure on the other side 
builds up and then at some time some pedestrians from that side slips through 
and so on. Figure \ref{fig:oscillitoryflow_litterature} shows the 
presentations of the oscillatory flow from \cite{oscil}. This describtions 
fits with what we ourself experince through simulations of the model too.

\begin{figure}[h]
\centering
\subfloat[Screen shot of oscillatory flow from 
\cite{oscil}]{\includegraphics[width=0.5\textwidth]{Figures/oscil_flow.png}}
\caption{Here one can see that some black pedestrians that already have slip through and now the white pedestrians going in the other direction a passing through the bottleneck.}
\label{fig:oscillitoryflow_litterature}
\end{figure}


\subsection{Summery}
We have been able to get a working simulation of the social force model 
presented in \cite{self-org} with components taken from \cite{ABconstant}. 
The most basic dynamics og the simulations seems to be running like as it 
should and our simulations show lane formation in bidirectional flow. We also  
see oscillatory flow at bottlenecks however freezin-by-heating 
and faster-is-slower effect is not observed at all.
